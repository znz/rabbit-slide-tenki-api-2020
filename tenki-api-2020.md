# livedoor天気API終了対応

author
:   Kazuhiro NISHIYAMA

content-source
:   LILO&東海道らぐオンライン
    ミーティング 2020-08-16

date
:   2020/08/16

allotted-time
:   10m

theme
:   lightning-simple

# 自己紹介

- Ruby コミッター
- Twitter, GitHub: `@znz`
- LILO のサーバー管理など

# livedoor Weather Hacks API

- city ID を指定して JSON などで天気情報が取得できる API
- 2020-07-31 14:00 提供終了
- https://help.livedoor.com/weather/index.html

# IRC tenki bot

- https://github.com/nadoka/nadoka の tenki bot で使っていた
- 「tenki> 大阪」
- 「tenki> 東京」
- 「tenki> 札幌」

# 乗り換え先検討

- 天気予報 API はそもそも少ない
- アカウント登録なしで取れるところはほぼない
- 有料のことも多い

# wttr.in

- https://github.com/chubin/wttr.in
- 簡単に使えて良さそうだった
- バックエンドの API のリクエスト数制限で止まったことがあった
- 頻繁にアクセスする用途には不向き?

# 気象庁

- http://www.jma.go.jp/jp/yoho/
- livedoor と情報は同じようだった (特に天気概況)
- スクレイピングは禁止されていない

# 最終的に気象庁を選択

- 都府県かもう少し細かいエリアでしかわかれていない
  (livedoor のような city 単位では指定できない)
- 「tenki> 大阪府」
- 「tenki> 東京都」
- 「tenki> 胆振・日高地方」

# 実行例

```
tenki>大阪府
tenki bot: 大阪府: 今日16日:晴れ(大阪: 日中の最高:38度)(12-18:10%;18-24:0%), 明日17日:晴れ(大阪: 朝の最低:27度,
日中の最高:37度)(00-06:0%;06-12:0%;12-18:0%;18-24:0%), 明後日18日:晴れ時々曇り
tenki bot: 　大阪府は、高気圧に覆われて晴れています。 (令和０２年８月１６日１０時３２分　大阪管区気象台発表)
tenki>東京都
tenki bot: 東京地方: 今日16日:曇り一時雨(東京: 日中の最高:37度)(12-18:50%;18-24:40%), 明日17日:曇り時々晴れ(東京:
朝の最低:27度,日中の最高:35度)(00-06:20%;06-12:10%;12-18:30%;18-24:30%), 明後日18日:曇り時々晴れ
tenki bot: 伊豆諸島北部: 今日16日:晴れ後曇り(大島: 日中の最高:35度)(12-18:10%;18-24:20%), 明日17日:曇り時々晴れ
(大島: 朝の最低:26度,日中の最高:33度)(00-06:10%;06-12:10%;12-18:10%;18-24:10%), 明後日18日:曇り時々晴れ
tenki bot: 伊豆諸島南部: 今日16日:晴れ後曇り(八丈島: 日中の最高:33度)(12-18:10%;18-24:20%), 明日17日:曇り後時々
晴れ(八丈島: 朝の最低:27度,日中の最高:32度)(00-06:10%;06-12:10%;12-18:10%;18-24:10%), 明後日18日:曇り時々晴れ
tenki bot: 小笠原諸島: 今日16日:曇り時々晴れ(父島: 日中の最高:33度)(12-18:20%;18-24:20%), 明日17日:曇り後時々
晴れ(父島: 朝の最低:26度,日中の最高:32度)(00-06:30%;06-12:30%;12-18:20%;18-24:10%), 明後日18日:晴れ時々曇り
tenki bot: 　日本の南には高気圧があって西へ移動しています。一方、前線が日本海から東北南部を通り、日本の東へのびて
います。 (令和０２年８月１６日１０時３７分　気象庁予報部発表)
tenki>胆振・日高地方
tenki bot: 胆振地方: 今日16日:晴れ時々曇り(室蘭: 日中の最高:28度)(12-18:0%;18-24:10%), 明日17日:晴れ時々曇り
(室蘭: 朝の最低:20度,日中の最高:28度)(00-06:10%;06-12:0%;12-18:0%;18-24:0%), 明後日18日:晴れ時々曇り
tenki bot: 日高地方: 今日16日:晴れ時々曇り(浦河: 日中の最高:24度)(12-18:0%;18-24:10%), 明日17日:晴れ時々曇り
(浦河: 朝の最低:19度,日中の最高:24度)(00-06:10%;06-12:0%;12-18:0%;18-24:0%), 明後日18日:晴れ時々曇り
tenki bot: 　北海道付近は、１７日にかけて低気圧を含む気圧の谷の中で、１６日は大気の状態が不安定となるでしょう。
(令和０２年８月１６日１０時３７分　室蘭地方気象台発表)
```

# その他

- zabbix でも使っていたがあまり見ていなかったので停止
- Google カレンダーに追加していた「livedoor 天気情報が配信する iCal フォーマットでの今日明日・週間の天気予報」も停止
